{"pages":[{"title":"about asuracoder","text":"ⓒillustrated by Takashi Mifune(irasutoya.com) 아수라코더낮엔 (코딩과 전혀 관계없는)회사에서 일하고 집에 오면 취미로 코딩을 하는 N년차 직장인입니다.취미로 시작했는데 그래도 몇년 하다보니 실력도 조금씩 늘고 직접 만든 어플을 회사에서도 업무용으로 사용하고 있습니다. 아수라는 삼면육비(세개의 얼굴에 여섯개의 팔)를 가진 요괴입니다.한 사람이 여러명의 몫을 해낸다는 뜻으로도 사용된다고 해서 저와 맞는 캐릭터라고 생각을 했습니다.여러개의 PC를 놓고 왔다 갔다 작업하는 제 모습과 비슷해보이기도 했구요 😀 SkillsPythonKotlinDart/FlutterR 관심사Machine Learning (Tensorflow)알고리즘트레이딩모바일 어플리케이션(안드로이드, iOS = Flutter)웹앱(Django) 포트폴리오곧 추가하겠습니다 😐","link":"/about/index.html"}],"posts":[{"title":"프로젝트를 시작하며(플러터를 선택한 이유)","text":"프로젝트명은 가칭 ‘책벗’입니다. 빠르고 강력한 멀티플랫폼 독서기록 어플을 만드는 게 최종 목표입니다. 직접 사용할 목적으로 만드는 앱이고 무료로 공개할 생각입니다. 그래서 서버 비용이 발생되지 않도록 사용자가 많지 않았으면 좋겠습니다.(저 같은 하드코어 독서가를 위한 앱입니다.) 특징 멀티플랫폼 지원안드로이드, iOS, 웹앱을 지원합니다.데이터 통합을 위해 로그인을 필요로합니다. 대량입력 지원앱을 만드는 직접적인 이유입니다. 엑셀처럼 대량의 도서정보를 TEXT기반으로 입력할 수 있습니다. 계속적인 기능확장아이패드 및 맥용 별도 앱, 위젯을 이용한 도서메모 리마인드기능, 노션/에버노트 내보내기, 책 추천 등 생각하고 있는 많은 기능들을 하나씩 추가해 나갈 생각입니다. 사용언어/플랫폼 안드로이드Frontend : Flutter일부 Native Kotlin 코드 사용 iOSFrontend : Flutter일부 Native Swift 코드 사용 웹앱Flutter BackEnd저장소는 Firebase 사용 : AWS는 아직 플러터를 지원하지 않으므로 어쩔 수 없는 선택회원정보를 다루어야 하므로 보안을 신경안써도 되는 Django를 이용할 생각 Flutter를 선택한 이유팀의 부재저는 팀 없이 혼자 코딩 작업을 하고 있습니다. 첫 번째 모바일 어플은 Kotlin으로 만든 안드로이드 앱이었는데 iOS용으로 따로 개발하는 부담이 있었습니다. 저 같은 개인개발자나 소규모 스타트업에는 코드 하나로 Android/iOS/Web 까지 한번에 빌드가 가능한 Flutter는 매력적인 제안입니다. 혼자 작업하기 때문에 최신 버전의 Flutter를 언제든 마음대로 적용해 작업할 수 있다는 점은 장점으로 작용합니다. 팀원끼리의 호환성을 걱정할 필요가 없기 때문이죠. 빠른 레이아웃 작업모바일앱 작업을 실제로 해보니 고난도의 기술이 필요한 앱이 아니면 레이아웃 편집에 들어가는 시간이 반 이상이었습니다. 레이아웃을 그림으로 그리는게 아니라 하나씩 코드로 만들다보니 변경한 코드를 빌드해서 확인하는 시간이 많이 걸렸는데요, 플러터의 Hot Reload는 정말 빠르고 편리하게 수정된 사항을 확인할 수 있어 작업시간이 줄어드는 것을 체감할 수 있었습니다. 편리한 비동기 코드Kotlin으로 작업할 때 코루틴이나 LiveData를 이용한 비동기 작업도 편리하긴 했지만 사용성 측면에서 Flutter의 async/await이 더 쉬운 느낌이었습니다. 이제 개발을 시작하는 단계라 어떤 벽에 부딪힐 지는 모르겠지만 Flutter를 쓰면서 생기는 문제와 해결과정을 블로그에 정리해나갈 생각입니다.","link":"/2021/11/13/flutter-bookbirdie-1/"},{"title":"알고리즘 트레이딩, 2년간의 성과(1)","text":"알고리즘 트레이딩을 시작하고 이달로 2년이 지났습니다. 제목만 보면 마치 2년간의 성과를 정리하는 최종 결과물 같지만 사실은 2년간 겪은 경험과 함께 앞으로의 방향을 제시하는 이정표가 될 글입니다. 카테고리의 첫 글부터 끝내버리면 아쉽기도 하고요. 알고리즘 트레이딩의 시작알고리즘 트레이딩은 말 그대로 정해진 알고리즘에 따라 컴퓨터가 주식거래를 자동으로 해주는 것을 말합니다. 처음 시작은 단순한 생각에서 비롯되었습니다. ① 돈을 벌려면 주식투자를 해야 한다.② 나는 회사에서 주식거래를 할수는 없다.&nbsp;&nbsp;&nbsp; (바쁘기도 하거니와 업무중 딴짓은 금지되어 있다.)③ 나 대신 누군가 날 위해 주식거래를 해주면 좋겠다. → 그러면 똘똘한 컴퓨터가 나 대신 거래를 해 준다면? BINGO!머리가 맑아지는 느낌이었습니다.나 대신 나보다 엄청 빠른 머리와 손을 가진 컴퓨터가 쉬지 않고 주식을 거래하게 하자!‘나는 회사일을 하고 내 PC는 하루종일 주식투자를 한다’는 컨셉은 마치 분신술을 쓰는 것과 같은 생각이 들었습니다. 게다가 100만원만 벌어도 빨리 팔아서 수익을 실현하고 싶어하는 저와 달리 부화뇌동 하지 않고 오로지 매매원칙에 따라 사고 파는 CPU는 명석한 투자고문처럼 믿음직스러울 것 같았습니다. 그래서 많은 분들이 그랬듯이알고리즘 트레이딩의 바이블 “파이썬으로 배우는 알고리즘 트레이딩”을 구매해서 본격적으로 공부를 시작했습니다. 파이썬으로 배우는 알고리즘 트레이딩(조대표 저)이미지출처: 카카오 책검색 v1. 첫 거래와 수익증권사 선택알고리즘 트레이딩을 할 때 많이 쓰는 증권사는 대우증권, 이베스트투자증권, 키움증권이 있습니다. 특히 키움증권은 저렴한 수수료로 국내 점유율 1위를 달리고 있는 MTS계의 제왕이었기에 저도 키움으로 시작할 생각이었습니다. 키움은 다른 두곳과 달리 OCX 방식을 사용하기 때문에 PyQT가 필수였지만, 어차피 멀티태스킹이나 루프의 편의성을 생각하면 어느 곳을 선택하든 PyQT는 필수였으므로 큰 문제는 아니었습니다. 하지만 맨땅에서 시작하는 코딩은 진도가 더디게 나가는 문제가 있었고, 검색을 통해 thinkalgo 알고리즘 트레이딩 사이트(Thinkalgo)에서 만든 mymoneybot 이라는 트레이딩봇을 알게 되었습니다. 거래 알고리즘만 봇 형태로 집어넣으면 바로 사용가능한 거의 완성된 형태의 프로그램이었습니다. 게다가 거래 현황을 텔레그램으로 실시간 전송도 해주는 멋진 기능도 있었습니다. (아쉽게도 지금은 서비스가 종료되었습니다.) 이 mymoneybot이 이베스트투자증권용으로 만들어져 있었고 그래서 이베스트를 주력 증권사로 삼아 시작했습니다. 작동원리원리는 간단합니다. 이베스트에서는 조건검색식을 파일로 저장하는 기능이 있고, 이 파일을 봇에서 사용하여 조건검색이 가능합니다. 예를 들어 조건검색식을 아래와 같이 정해놓습니다. 직전 5일간 하향 추세였으나 어제 종가보다 오늘 시작가 높고 거래량이 TOP 30위 안에 드는 종목 그러면 이 종목들이 실시간으로 리스트에 추가/삭제되어 매수를 합니다. 매수 후에 목표한 수익률에 도달하면 해당 종목을 팔도록 설정하구요. 저는 약간의 주식 공부를 병행하면서 흔히 말하는 급등주 찾는 공식을 대입해서 실전에 돌입하였습니다. 처음엔 그저 자동으로 주식을 사고 파는 제 PC가 기특하기만 했고, 수익도 꽤 발생했습니다. 어떤날은 자본금이 200만원인데 하루에 50만원을 벌어들여 +25%의 이익을 보기도 했죠. 하지만, 주식시장은 제가 생각한 것보다 훨씬 복잡하고 위험한 곳이었습니다. 이상현상 발생갑자기 손실이 발생했습니다. 단타를 치는 분들은 아시겠지만 9시 장이 열리면서 엄청난 거래량이 발생됩니다. 대부분의 단타 거래는 9시부터 9시10분사이에 모두 끝난다고 해도 과언이 아닙니다. 이 10분 사이에 저는 자산의 2-30%의 손실을 보기도 했습니다. 물론 시험단계여서 많은 돈을 넣어놓지는 않았지만 10분간 발생한 손실을 메꾸는 데에는 오랜 시간이 걸렸습니다. 손실이 발생한 이유를 분석해보니 제 알고리즘이 낚시에 걸려들었음을 알 수 있었습니다. 급등주를 찾기 위해 짧은 시간에 가격과 거래량이 높아지는 종목을 검색하도록 되어있었는데 누군가 고의로 가격을 갑자기 올린 것에 낚인거죠. 시가가 20,000원인 종목을 22,000원까지 순식간에 올려 알고리즘이 급등주로 파악해 매수하면 갑자기 물량을 풀어 18,000~19,000원까지 가격을 떨어뜨리는 수법이었습니다. 일정 손실이 넘어가면 손절매를 하도록 코드를 작성했기 때문에 당일 최고가에 사서 저가에 파는 바보같은 짓을 한 겁니다. 아래와 같은 손절매 코드를 넣어놓았습니다. 1234if 현재가 &lt; P.매수가 * (1-self.losscut): self.매도Lock[단축코드] = '' self.금일매도종목.append(단축코드) 희망가 = 현재가 그래서 저는 대응책을 고민하며 코딩 공부와 주식 공부를 병행하기 시작했습니다. 짧으면 1분내에 승부가 나는 광기의 시장에서 조금이라도 승률을 높이려면 빠르고 효율적인 코드가 필요했고, 돈이 걸린 냉혹한 거래소에서 속지 않기 위한 지혜가 필요했기 때문입니다. v2. 머신러닝 도입첫 시작은 저를 위해 하루종일 단타매매를 해주는 로봇을 만드는 것이었지만 계속된 테스트 결과 단순한 알고리즘 만으로는 단타로 수익을 내기 힘들다는 결론을 얻었습니다. 단타의 고수로 인정받은 유튜버 ‘창원개미’님의 영상을 보면 단타매매의 성공에는 공식보다는 오래된 경험과 동물적 감각이 더 필요하다는 것을 알 수 있습니다. 오래된 경험을 컴퓨터에게 주입해 주는 것.저는 머신러닝을 도입하게 됩니다. 쓰다보니 글이 길어져서, 다음편에 계속하겠습니다.","link":"/2021/11/14/algorithm-start/"},{"title":"알고리즘 트레이딩, 2년간의 성과(2)","text":"&lt; 1편에 이어 계속 됩니다 &gt; 첫 시작은 저를 위해 하루종일 단타매매를 해주는 로봇을 만드는 것이었지만 계속된 테스트 결과 단순한 알고리즘 만으로는 단타로 수익을 내기 힘들다는 결론을 얻었습니다. 그래서 저는 컴퓨터에게 경험을 주입해 주는 일, 머신러닝을 도입합니다. 머신러닝 적용Tensorflow를 공부하다머신러닝을 써야겠다!고 마음은 먹었지만 이제 막 Python을 얕게 익힌 저는 머신러닝의 ㅁ도 모르는 상태였습니다. 그래서 머신러닝의 바이블이라는 ‘핸즈온 머신러닝(2판)’을 구입해서 읽었습니다. 머신러닝의 바이블, 핸즈온 머신러닝 (오렐리앙 제롱 저)이미지 출처: 카카오 책검색 언어를 처음 배울 때 젊은 사람은 온라인으로 배우고 올드한 세대는 책으로 배운다고 하는데 저는 확실히 올드한 모양입니다. 처음 이 책에 입문할 때는 1판만 나와서 1판을 구입해서 읽었는데 책은 Tensorflow 1기반이었고 PC에는 Tensorflow 2를 설치해놓아서 코드가 제대로 실행이 안됐습니다. (무조건 새 버전이 좋은줄 알고 2를 깔았을 정도로 무식했습니다.) 다행히 금방 텐서플로2가 적용된 개정판이 나와서 개정판을 구매해서 계속 공부를 했습니다. 하지만 머신러닝을 공부하면 할수록 주식 거래에 적용하는 게 쉽지 않다는 사실을 깨달았습니다. 문제는 ‘데이터’였습니다. 주가 데이터의 한계분류법이든 선형학습이든 머신러닝의 기본 전제는 ①원인과 결과가 밀접하게 관련된 ②많은 데이터를 주고 ‘학습’을 시키는 것입니다. 주가 데이터는 이 두가지점 모두에 한계가 있습니다. 주가 데이터의 인과관계 통상 주식 거래에 쓰는 데이터는 2가지입니다. 가격(P)과 거래량(Q). 이 두 가지 요소가 다음 가격에 지대한 영향을 미칩니다. 하지만 실질적으로 주가를 결정하는 것은 투자자의 심리입니다. 같은 종목의 가격과 거래량 정보를 보고 누군가는 가격이 더 오를 것이라 생각하고 사고, 누군가는 가격이 떨어질 것으로 보고 팝니다. 결국 어떤 종목은 오늘 가격이 떨어지는데 내일 오르고, 또 다른 종목은 오늘 가격이 떨어졌는데 내일은 더 떨어지는 일이 발생됩니다. 이런 데이터를 집어넣으면 아무리 성능이 좋은 머신러닝 라이브러리라도 다음 상황을 예측할 수가 없습니다. 가격과 거래량 사이에 어떠한 인과관계도 발견할 수가 없기 때문입니다. 데이터의 양주가 데이터의 양도 부족했습니다. 시가, 종가, 고가, 저가, 하루 4개의 가격과 거래량을 입력한다고 쳐도 1년에 장이 열리는 영업일은 고작 250일 가량입니다. 10년치 데이터를 넣어도 2,500개 밖에 안됩니다. 데이터의 양을 늘리기 위해 일별종가가 아닌 시간대별 종가, 분당 종가, 최종적으로는 체결되는 모든 거래의 가격 변화인 틱 데이터까지 넣어봐도 결과는 비슷했습니다. 오히려 틱 데이터는 의미없는 가격의 오르내림만 있다보니 인과관계가 더 소멸되는 느낌이었습니다. 결국 정제되지 않은 데이터로는 시계열 분석에 좋다는 RNN이든 인공신경망 할애비든 뭘 적용해도 좋은 결과를 얻기가 힘들었습니다. v3.강화학습과 주식이론의 종합정답은 하나가 아니다결국 ‘주식은 종합예술이다’는 가르침은 진리였음을 다시 한 번 확인하고. 기본으로 돌아갔습니다. 유명한 실전투자가 이정윤님의 저서 ‘삼박자 투자법’에서 재무제표 분석, 차트분석, 재료분석 세 가지를 갖춰야 제대로된 주식투자라고 했습니다. 삼박자 투자법(이정윤 저)이미지 출처: 카카오 책검색 그래서 저도 제 트레이딩 시스템에 이 세 가지를 다 반영하기로 했습니다. 재무제표재무제표는 전통적인 알고리즘을 적용했습니다.PER와 적정 부채비중, 시가총액 범위 등을 지정하고 주로 투자배제 종목을 골라내는 용도로 사용합니다. 여기에는 이베스트증권의 종목검색식을 활용하기도 합니다. 차트분석차트에 크게 비중을 두지는 않습니다. 위에서 봤듯이 차트가 움직이는 것은 변동된 가격의 결과를 확인하는 것 이상의 의미는 없습니다. 다만 많은 사람들이 차트를 보고 투자결정을 내리므로 투자심리를 예측하는 툴로는 어느 정도 기능할거라고 생각합니다. 요즘은 추세선을 보고 우하향하는 종목은 매수범위에서 배제하고 직전 2주 차트로 고점, 저점, 손절 포인트를잡는 정도로 사용하고 있습니다. 재료분석재료는 소문과 언론이 많이 만들어냅니다. 언론에 뜨면 이미 늦었다고 봐야하지만 재료가 갖춰지기 전에 사전에 깔리는 뉴스들이 있습니다. 투자를 유치했다, 거래를 수주했다, 수익이 개선됐다 등. 그래서 재료분석은 크롤링을 통해 주요 포털의 주식관련 게시판과 경제 뉴스를 모아 분석하고 있습니다. 강화학습여기에 추가로 제가 의미를 크게 두는 것은 호가잔량입니다. 호가잔량은 실시간으로 변화하면서 매도호가 매수호가의 균형점이 곧 거래가가 되니 어느 정도 유의미한 데이터라고 볼 수 있습니다. 그래서 호가잔량을 보고 단타매매하는 강화학습 모듈을 만들었습니다. (요건 아직 미완성입니다) 아수라 트레이더의 흐름제 트레이딩봇 이름을 아수라트레이더라고 해보겠습니다. 이 녀석이 주식거래를 하는 방법은 아래와 같습니다. 재무제표 분석을 통해 거래가능한 종목과 불가능한 종목을 나눕니다. 크롤링 머신은 계속 기사와 주식 게시물을 검색하며 재료를 찾습니다. NLP를 적용해서 ‘긍정’, ‘부정’ 2가지로만 구분합니다. 차트에서 하락세인 종목은 배제하고 상승세에 있는 종목을 찾습니다. 1 &amp; 2 &amp; 3 교집합을 찾아 호가잔량을 모니터합니다. 거래량이 많은 종목에 가중치를 둡니다. 상승 가능성이 있는 종목을 매수합니다. 이 단계는 강화학습으로 작동합니다. 매수후 가격이 상승하는지 하락하는지 평가합니다. 평가 결과를 강화학습에 반영합니다. 4번으로 돌아가 반복합니다. 장 종료후 그날의 가격변동을 보고 1~3번 단계에 문제는 없었는지, 오늘 상한가와 하한가 종목은 어떤 것이었는지, 그 종목들을 내 타겟리스트는 어떻게 취급하였는지를 리뷰합니다. 리뷰 결과를 코드에 반영합니다. 이때 수정한 코드로 결과가 더 나빠질 수 있기 때문에 버전관리를 해야합니다. 어느 정도 형태가 갖춰지면 각 모듈의 코드를 일부소개하는 포스트도 써보도록 하겠습니다. 오늘도 열일 후 포스팅을 했더니 피곤하네요.다음에 뵙겠습니다.","link":"/2021/11/15/algorithm-start2/"}],"tags":[{"name":"flutter","slug":"flutter","link":"/tags/flutter/"},{"name":"dart","slug":"dart","link":"/tags/dart/"},{"name":"android","slug":"android","link":"/tags/android/"},{"name":"플러터","slug":"플러터","link":"/tags/%ED%94%8C%EB%9F%AC%ED%84%B0/"},{"name":"안드로이드","slug":"안드로이드","link":"/tags/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C/"},{"name":"iOS","slug":"iOS","link":"/tags/iOS/"},{"name":"스마트폰","slug":"스마트폰","link":"/tags/%EC%8A%A4%EB%A7%88%ED%8A%B8%ED%8F%B0/"},{"name":"책벗","slug":"책벗","link":"/tags/%EC%B1%85%EB%B2%97/"},{"name":"bookbirdie","slug":"bookbirdie","link":"/tags/bookbirdie/"},{"name":"알고리즘트레이딩","slug":"알고리즘트레이딩","link":"/tags/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%ED%8A%B8%EB%A0%88%EC%9D%B4%EB%94%A9/"},{"name":"python","slug":"python","link":"/tags/python/"},{"name":"주식","slug":"주식","link":"/tags/%EC%A3%BC%EC%8B%9D/"},{"name":"자동주식거래","slug":"자동주식거래","link":"/tags/%EC%9E%90%EB%8F%99%EC%A3%BC%EC%8B%9D%EA%B1%B0%EB%9E%98/"},{"name":"봇트레이딩","slug":"봇트레이딩","link":"/tags/%EB%B4%87%ED%8A%B8%EB%A0%88%EC%9D%B4%EB%94%A9/"},{"name":"퀀트","slug":"퀀트","link":"/tags/%ED%80%80%ED%8A%B8/"},{"name":"인공지능","slug":"인공지능","link":"/tags/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5/"},{"name":"tensorflow","slug":"tensorflow","link":"/tags/tensorflow/"}],"categories":[{"name":"Flutter","slug":"Flutter","link":"/categories/Flutter/"},{"name":"프로젝트 책벗","slug":"Flutter/프로젝트-책벗","link":"/categories/Flutter/%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EC%B1%85%EB%B2%97/"},{"name":"알고리즘트레이딩","slug":"알고리즘트레이딩","link":"/categories/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%ED%8A%B8%EB%A0%88%EC%9D%B4%EB%94%A9/"}]}